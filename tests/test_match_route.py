"""
Tests de andi.webservice.match
"""
from decimal import Decimal
from uuid import uuid4
from andi.webservice.schemas.match import MatchQueryModel, Address, AddressTypes, PositiveInt
from andi.webservice.library import utc_now
import andi.webservice.match as target


def test_selected_nafs_from_romes():
    result, _ = target.selected_nafs_from_romes(["A1101"])
    assert result == {'0161Z': '5', '7731Z': '4', '0210Z': '3', '0114Z': '3', '0220Z': '3', '0141Z': '3', '0111Z': '2',
                      '1091Z': '1', '7830Z': '1', '4941B': '1', '4941A': '1', '4312A': '1', '0121Z': '1', '0146Z': '1',
                      '2365Z': '1'}


# Résultats pour recherche
# ROME = D1106
# distance = 1km
# Adresse = 12, rue François Bonvin - 75015 Paris

expected = [
    {'id': 7839658, 'nom': 'LAURA TODD', 'adresse': '47 Avenue de Ségur 75007 Paris', 'siret': '56210010700092',
     'taille': '10-19', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 7', 'departement': '75', 'phonenumber': '0142731080', 'distance': Decimal('0.6'),
     'lat': Decimal('48.850313'), 'lon': Decimal('2.308948'), 'score_naf': 4, 'score_welcome': 4,
     'score_contact': 3, 'score_size': 5, 'score_geo': 3, 'score_total': 61},
    {'id': 8264464, 'nom': 'MONOPRIX EXPLOITATION, PAR ABREVIATION MPX',
     'adresse': '72 Rue Lecourbe 75015 Paris', 'siret': '55208329701372', 'taille': '50-99', 'naf': '4711D',
     'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75', 'phonenumber': '0142730330',
     'distance': Decimal('0.2'), 'lat': Decimal('48.843699'), 'lon': Decimal('2.305805'), 'score_naf': 4,
     'score_welcome': 4, 'score_contact': 1, 'score_size': 5, 'score_geo': 5, 'score_total': 59},
    {'id': 7858742, 'nom': 'LAECINE', 'adresse': '43 Avenue de Saxe 75007 Paris', 'siret': '79873013100033',
     'taille': '10-19', 'naf': '4711B', 'sector': "Commerce d'alimentation générale", 'commune': 'PARIS 7',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.847929'),
     'lon': Decimal('2.311025'), 'score_naf': 3, 'score_welcome': 4, 'score_contact': 3, 'score_size': 5,
     'score_geo': 4, 'score_total': 58},
    {'id': 8254012, 'nom': 'EWAN', 'adresse': '89 Rue Cambronne 75015 Paris', 'siret': '51135763400027',
     'taille': '10-19', 'naf': '4722Z',
     'sector': 'Commerce de détail de viandes et de produits à base de viande en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842461'), 'lon': Decimal('2.302949'), 'score_naf': 3, 'score_welcome': 4,
     'score_contact': 1, 'score_size': 5, 'score_geo': 5, 'score_total': 54},
    {'id': 8270645, 'nom': 'DISTRI LECOURBE', 'adresse': '113 Rue Lecourbe 75015 Paris',
     'siret': '81060679800025', 'taille': '10-19', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842299'), 'lon': Decimal('2.302262'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 3, 'score_size': 5, 'score_geo': 5, 'score_total': 53},
    {'id': 8243479, 'nom': 'SUFFREN', 'adresse': '166 Avenue de Suffren 75015 Paris', 'siret': '34453000100017',
     'taille': '10-19', 'naf': '1071C', 'sector': 'Boulangerie et boulangerie-pâtisserie',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'),
     'lat': Decimal('48.846299'), 'lon': Decimal('2.308255'), 'score_naf': 5, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 5, 'score_total': 52},
    {'id': 8279535, 'nom': 'LE COMPTOIR DE MILANA', 'adresse': '110 Rue Lecourbe 75015 Paris',
     'siret': '80463193500025', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.842808'), 'lon': Decimal('2.302974'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 5,
     'score_total': 52},
    {'id': 8286703, 'nom': 'MAISON LANDEMAINE CAMBRONNE', 'adresse': '7 Place Cambronne 75015 Paris',
     'siret': '83093949200013', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.847541'), 'lon': Decimal('2.302095'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 5,
     'score_total': 52},
    {'id': 8249144, 'nom': 'PICHARD PATISSIER', 'adresse': '88 Rue Cambronne 75015 Paris',
     'siret': '43856208400014', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842272'), 'lon': Decimal('2.302804'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 5,
     'score_total': 52},
    {'id': 8235851, 'nom': 'UNIMAG', 'adresse': '4 Rue Dupleix 75015 Paris', 'siret': '32862092700017',
     'taille': '20-49', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': '0147343123', 'distance': Decimal('0.9'), 'lat': Decimal('48.852044'),
     'lon': Decimal('2.298637'), 'score_naf': 4, 'score_welcome': 4, 'score_contact': 1, 'score_size': 5,
     'score_geo': 1, 'score_total': 51},
    {'id': 8281006, 'nom': 'BOULANGERIE BARLAN', 'adresse': '22 Rue Cambronne 75015 Paris',
     'siret': '81383940400015', 'taille': '6-9', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.846388'), 'lon': Decimal('2.30172'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4, 'score_geo': 5,
     'score_total': 50},
    {'id': 8264443, 'nom': 'LE MOULIN DE LA CROIX NIVERT', 'adresse': '39 Rue de la Croix Nivert 75015 Paris',
     'siret': '80838011700016', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.845996'), 'lon': Decimal('2.298911'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 4,
     'score_total': 50},
    {'id': 8273667, 'nom': 'SAS BOULAY', 'adresse': '228 Rue de Vaugirard 75015 Paris',
     'siret': '50051887300038', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.5'),
     'lat': Decimal('48.840633'), 'lon': Decimal('2.304652'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 4,
     'score_total': 50},
    {'id': 8244455, 'nom': 'LE GATEAU BATTU', 'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '34965550600013', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'), 'lon': Decimal('2.3002449'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 4,
     'score_total': 50},
    {'id': 8269213, 'nom': 'SUPER FRANPRIX', 'adresse': '67 Rue de la Croix Nivert 75015 Paris',
     'siret': '73202623200015', 'taille': '20-49', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': '0148422114', 'distance': Decimal('0.6'),
     'lat': Decimal('48.844361'), 'lon': Decimal('2.296809'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 3, 'score_size': 5, 'score_geo': 3, 'score_total': 49},
    {'id': 7812786, 'nom': "CHARLES BEN'S", 'adresse': '135 Rue de Sèvres 75006 Paris',
     'siret': '81175869700023', 'taille': '6-9', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 6',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.9'), 'lat': Decimal('48.847114'),
     'lon': Decimal('2.317817'), 'score_naf': 4, 'score_welcome': 4, 'score_contact': 1, 'score_size': 4,
     'score_geo': 1, 'score_total': 49},
    {'id': 8270893, 'nom': 'A.M. MARTINHO', 'adresse': '10 Rue des Volontaires 75015 Paris',
     'siret': '49902974200016', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.842898'), 'lon': Decimal('2.306851'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 5,
     'score_total': 48},
    {'id': 8246566, 'nom': 'SANA', 'adresse': '18 Rue Valentin Haüy 75015 Paris', 'siret': '43493634000018',
     'taille': '3-5', 'naf': '1071C', 'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.846691'),
     'lon': Decimal('2.308812'), 'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 5, 'score_total': 48},
    {'id': 8279587, 'nom': 'LA TRADITION DE CAMBRONNE', 'adresse': '23 Rue de la Croix Nivert 75015 Paris',
     'siret': '82808423600011', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.846714'), 'lon': Decimal('2.299965'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 5,
     'score_total': 48},
    {'id': 8274436, 'nom': 'SARL ANTOINE', 'adresse': '231 Rue de Vaugirard 75015 Paris',
     'siret': '80276182500016', 'taille': '6-9', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.5'),
     'lat': Decimal('48.841317'), 'lon': Decimal('2.307622'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 4, 'score_geo': 4,
     'score_total': 48},
    {'id': 8251237, 'nom': 'SARL P.P.', 'adresse': '115 Boulevard de Grenelle 75015 Paris',
     'siret': '48373475200015', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.849078'), 'lon': Decimal('2.298611'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 3,
     'score_total': 48},
    {'id': 8263308, 'nom': 'SOCIETE DE BOULANGERIE DU COMMERCE',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '42411222500018', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8401192'), 'lon': Decimal('2.3024489'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 3,
     'score_total': 48},
    {'id': 8243872, 'nom': 'BOULANGERIE PATISSERIE D.NEVES',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '34764265400045', 'taille': '6-9', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None,
     'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'),
     'lon': Decimal('2.3002449'), 'score_naf': 5, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 4,
     'score_total': 48},
    {'id': 8273712, 'nom': 'DISTRIPERIGNON', 'adresse': '36 Rue Pérignon 75015 Paris',
     'siret': '80245711900021', 'taille': '10-19', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'),
     'lat': Decimal('48.846818'), 'lon': Decimal('2.306245'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 5, 'score_total': 47},
    {'id': 8250587, 'nom': 'DAGUERRE MAREE', 'adresse': '93 Rue Lecourbe 75015 Paris',
     'siret': '41396502100012', 'taille': '10-19', 'naf': '4723Z',
     'sector': 'Commerce de détail de poissons, crustacés et mollusques en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.842882'), 'lon': Decimal('2.303966'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 5, 'score_total': 47},
    {'id': 8254378, 'nom': 'ZERZOUR MOHAMED', 'adresse': "50 Rue de l'Amiral Roussin 75015 Paris",
     'siret': '44199328400013', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.843277'), 'lon': Decimal('2.299884'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 4,
     'score_total': 46},
    {'id': 8267700, 'nom': 'BOULANGERIE AURELIA',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '80951924200014', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8413462'), 'lon': Decimal('2.3002449'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 4,
     'score_total': 46},
    {'id': 8278670, 'nom': 'BORISSOU', 'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '81298474800010', 'taille': '6-9', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8401192'), 'lon': Decimal('2.3024489'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4, 'score_geo': 3,
     'score_total': 46},
    {'id': 8266111, 'nom': "MOISAN - LE PAIN BIO A L'ANCIENNE", 'adresse': '57 Rue Fondary 75015 Paris',
     'siret': '79926533500023', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.7'), 'lat': Decimal('48.84727'), 'lon': Decimal('2.295488'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 46},
    {'id': 7841062, 'nom': 'MAISON LALLEMENT', 'adresse': '37 Avenue Duquesne 75007 Paris',
     'siret': '71200021500012', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 7',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.8'),
     'lat': Decimal('48.851595'), 'lon': Decimal('2.310656'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 46},
    {'id': 8258242, 'nom': 'M G M NIVERT', 'adresse': '27 Villa Croix Nivert 75015 Paris',
     'siret': '42141998700019', 'taille': '6-9', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.845613'), 'lon': Decimal('2.301227'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 45},
    {'id': 8256929, 'nom': 'LECOURBE DISTRIBUTION', 'adresse': '105 Rue Lecourbe 75015 Paris',
     'siret': '44363494400021', 'taille': '6-9', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842612'), 'lon': Decimal('2.303064'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 45},
    {'id': 8266213, 'nom': 'MEUNIER FRERES', 'adresse': '105 Rue Lecourbe 75015 Paris',
     'siret': '59201544000015', 'taille': '6-9', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': '0140560403', 'distance': Decimal('0.4'), 'lat': Decimal('48.842612'),
     'lon': Decimal('2.303064'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4,
     'score_geo': 5, 'score_total': 45},
    {'id': 8253961, 'nom': 'SARL ZERZOUR 3', 'adresse': '49 Rue Cambronne 75015 Paris',
     'siret': '51132536700015', 'taille': '0', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.2'), 'lat': Decimal('48.844626'), 'lon': Decimal('2.302327'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 5,
     'score_total': 44},
    {'id': 8246168, 'nom': 'LOUHICHI MEHREZ', 'adresse': '71 Rue Lecourbe 75015 Paris',
     'siret': '43449963800022', 'taille': '0', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'),
     'lat': Decimal('48.843357'), 'lon': Decimal('2.305556'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 5,
     'score_total': 44},
    {'id': 8281449, 'nom': 'LA ROSE DE CAMBRONNE', 'adresse': '92 Rue Cambronne 75015 Paris',
     'siret': '83434902900027', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.841639'), 'lon': Decimal('2.303249'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 5,
     'score_total': 44},
    {'id': 8281668, 'nom': "LA P'TITE BOULANGERIE LECOURBE", 'adresse': '115 Rue Lecourbe 75015 Paris',
     'siret': '84903791600020', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.842249'), 'lon': Decimal('2.302099'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 5,
     'score_total': 44},
    {'id': 8291623, 'nom': 'LA CROQUANDISE', 'adresse': '10 Rue du Laos 75015 Paris', 'siret': '82016612200011',
     'taille': '3-5', 'naf': '1071C', 'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.850093'),
     'lon': Decimal('2.300976'), 'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 3, 'score_total': 44},
    {'id': 8249520, 'nom': 'LA CRAQUANTE DE NIVERT', 'adresse': '68 Rue de la Croix Nivert 75015 Paris',
     'siret': '48261127400010', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.844783'), 'lon': Decimal('2.296972'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 3,
     'score_total': 44},
    {'id': 8266148, 'nom': 'LE GRENIER A PAIN VAUGIRARD', 'adresse': '270 Rue de Vaugirard 75015 Paris',
     'siret': '58214354100016', 'taille': '6-9', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.839225'), 'lon': Decimal('2.300025'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4, 'score_geo': 2,
     'score_total': 44},
    {'id': 8257208, 'nom': 'LE GALLIC FABRICE', 'adresse': '133 Avenue Emile Zola 75015 Paris',
     'siret': '44381105400024', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.9'), 'lat': Decimal('48.847015'), 'lon': Decimal('2.293291'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 1,
     'score_total': 44},
    {'id': 7841955, 'nom': 'JUMEL JULIEN', 'adresse': '55 Avenue de Suffren 75007 Paris',
     'siret': '75076503400012', 'taille': '10-19', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 7',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('1.0'),
     'lat': Decimal('48.852905'), 'lon': Decimal('2.298438'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 1,
     'score_total': 44},
    {'id': 8243641, 'nom': 'CARREFOUR PROXIMITE FRANCE', 'adresse': '81 Rue Cambronne 75015 Paris',
     'siret': '34513048816104', 'taille': '3-5', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.843094'), 'lon': Decimal('2.302665'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 5, 'score_total': 43},
    {'id': 8283716, 'nom': 'ZM FRUITS', 'adresse': '89 Rue Lecourbe 75015 Paris', 'siret': '82978047700024',
     'taille': '3-5', 'naf': '4721Z', 'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.84298'), 'lon': Decimal('2.304296'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 5, 'score_total': 43},
    {'id': 8280854, 'nom': 'BOULANGERIE DE LECOURBE', 'adresse': '9 Rue Lecourbe 75015 Paris',
     'siret': '81374398600016', 'taille': '3-5', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.84468'), 'lon': Decimal('2.309991'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 5, 'score_total': 43},
    {'id': 8269005, 'nom': 'AU DELICE LECOURBE', 'adresse': '10 Rue Lecourbe 75015 Paris',
     'siret': '80051978700017', 'taille': '3-5', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.844898'),
     'lon': Decimal('2.310055'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 5, 'score_total': 43},
    {'id': 8278391, 'nom': 'LES HALLES CAMBRONNE', 'adresse': '95 Rue Cambronne 75015 Paris',
     'siret': '43393717400012', 'taille': '3-5', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.842177'),
     'lon': Decimal('2.30315'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 5, 'score_total': 43},
    {'id': 8243643, 'nom': 'CARREFOUR PROXIMITE FRANCE', 'adresse': '236 Rue de Vaugirard 75015 Paris',
     'siret': '34513048816112', 'taille': '6-9', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.840362'), 'lon': Decimal('2.303704'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 4, 'score_total': 43},
    {'id': 8240503, 'nom': 'SUPER HALLES 2000', 'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '30357499000014', 'taille': '10-19', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8401192'),
     'lon': Decimal('2.3024489'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5,
     'score_geo': 3, 'score_total': 43},
    {'id': 8246521, 'nom': 'PIERRE HERME', 'adresse': '185 Rue de Vaugirard 75015 Paris',
     'siret': '43485195200029', 'taille': '20-49', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.842694'), 'lon': Decimal('2.31208'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 3, 'score_total': 43},
    {'id': 8265088, 'nom': 'SA AUX HALLES DE PROVENCE',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris', 'siret': '56212212700011',
     'taille': '10-19', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8401192'),
     'lon': Decimal('2.3024489'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5,
     'score_geo': 3, 'score_total': 43},
    {'id': 8224729, 'nom': 'LES COMPTOIRS RICHARD', 'adresse': '73 Rue Lecourbe 75015 Paris',
     'siret': '31162451400106', 'taille': '20-49', 'naf': '4729Z',
     'sector': 'Autres commerces de détail alimentaires en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'), 'lat': Decimal('48.84331'),
     'lon': Decimal('2.305399'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5,
     'score_geo': 5, 'score_total': 42},
    {'id': 8270965, 'nom': "BIO C' BON IDF", 'adresse': '18 Rue Lecourbe 75015 Paris',
     'siret': '75043425000080', 'taille': '20-49', 'naf': '4729Z',
     'sector': 'Autres commerces de détail alimentaires en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.844717'),
     'lon': Decimal('2.309478'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5,
     'score_geo': 5, 'score_total': 42},
    {'id': 8272927, 'nom': 'LIBELLULE', 'adresse': '4 Place du Général Beuret 75015 Paris',
     'siret': '81133112300026', 'taille': '10-19', 'naf': '4729Z',
     'sector': 'Autres commerces de détail alimentaires en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.841905'),
     'lon': Decimal('2.302877'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5,
     'score_geo': 5, 'score_total': 42},
    {'id': 8271152, 'nom': 'BOULANGERIE HIS', 'adresse': '174 Rue de Vaugirard 75015 Paris',
     'siret': '80139334900015', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.842437'), 'lon': Decimal('2.310722'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 4,
     'score_total': 42},
    {'id': 7836089, 'nom': 'SAXE BOULANGE', 'adresse': '43 Avenue de Saxe 75007 Paris',
     'siret': '83404462000013', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 7',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.5'),
     'lat': Decimal('48.847929'), 'lon': Decimal('2.311025'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 4,
     'score_total': 42},
    {'id': 8300620, 'nom': 'BOULANGERIE DE VAUGERARD', 'adresse': '212 Rue de Vaugirard 75015 Paris',
     'siret': '84397952700010', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.841054'), 'lon': Decimal('2.306126'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 4,
     'score_total': 42},
    {'id': 8296997, 'nom': 'SAS LORETTE VOUILLE',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '87804354600018', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8413462'), 'lon': Decimal('2.3002449'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 4,
     'score_total': 42},
    {'id': 8269855, 'nom': 'AUX PLAISIRS DES PAPILLES', 'adresse': '10 Rue Maublanc 75015 Paris',
     'siret': '80092902800010', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.7'), 'lat': Decimal('48.839832'), 'lon': Decimal('2.299876'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 2,
     'score_total': 42},
    {'id': 8278167, 'nom': 'LE COMPAGNON DE PASTEUR', 'adresse': '49 Rue Falguière 75015 Paris',
     'siret': '81285718300014', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.841744'), 'lon': Decimal('2.31453'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 2,
     'score_total': 42},
    {'id': 8273411, 'nom': 'CHOCO-TENTATIONS', 'adresse': '88 Rue Lecourbe 75015 Paris',
     'siret': '50037206500010', 'taille': '1-2', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None,
     'distance': Decimal('0.2'), 'lat': Decimal('48.84334'), 'lon': Decimal('2.304737'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 2,
     'score_geo': 5, 'score_total': 41},
    {'id': 8292982, 'nom': 'DOUCEURS DE FRANCE', 'adresse': '41 Rue Lecourbe 75015 Paris',
     'siret': '82067571800028', 'taille': '1-2', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'),
     'lat': Decimal('48.84394'), 'lon': Decimal('2.307539'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 2, 'score_geo': 5, 'score_total': 41},
    {'id': 8245411, 'nom': 'A LA ROSE DE TUNIS', 'adresse': '92 Rue Cambronne 75015 Paris',
     'siret': '35264530300061', 'taille': '1-2', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.841639'), 'lon': Decimal('2.303249'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 2, 'score_geo': 5, 'score_total': 41},
    {'id': 7844046, 'nom': 'MORI YOSHIDA', 'adresse': '65 Avenue de Breteuil 75007 Paris',
     'siret': '75369100500015', 'taille': '6-9', 'naf': '1071D', 'sector': 'Pâtisserie', 'commune': 'PARIS 7',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.847994'),
     'lon': Decimal('2.312208'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4,
     'score_geo': 3, 'score_total': 41},
    {'id': 8270484, 'nom': 'MONSIEUR CHOCOLAT',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '49879585500028', 'taille': '3-5', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None,
     'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'),
     'lon': Decimal('2.3002449'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 4,
     'score_total': 41},
    {'id': 8243645, 'nom': 'CARREFOUR PROXIMITE FRANCE',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris', 'siret': '34513048816120',
     'taille': '3-5', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'), 'lon': Decimal('2.3002449'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 4,
     'score_total': 41},
    {'id': 8244720, 'nom': 'VAUGIDIS', 'adresse': '293 Rue de Vaugirard 75015 Paris', 'siret': '35052655400018',
     'taille': '20-49', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.839208'), 'lon': Decimal('2.300576'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 41},
    {'id': 8269958, 'nom': 'LAKADIS', 'adresse': '6 Rue Lakanal 75015 Paris', 'siret': '42938672500015',
     'taille': '10-19', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.844301'), 'lon': Decimal('2.29426'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 41},
    {'id': 8251813, 'nom': 'CSF', 'adresse': '40 Rue de la Procession 75015 Paris', 'siret': '44028375208252',
     'taille': '20-49', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.837975'), 'lon': Decimal('2.307237'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 41},
    {'id': 8239330, 'nom': 'MFP LUTECE', 'adresse': '65 Rue Falguière 75015 Paris', 'siret': '39244824700032',
     'taille': '10-19', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.840357'), 'lon': Decimal('2.312877'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 2,
     'score_total': 41},
    {'id': 8266089, 'nom': 'DISTRIBUTION CASINO FRANCE', 'adresse': '31 Rue Falguière 75015 Paris',
     'siret': '42826802338929', 'taille': '20-49', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.9'),
     'lat': Decimal('48.84261'), 'lon': Decimal('2.31629'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 2, 'score_total': 41},
    {'id': 8228405, 'nom': 'WA SENG', 'adresse': '18 Boulevard Garibaldi 75015 Paris',
     'siret': '38160392700017', 'taille': '6-9', 'naf': '4711B', 'sector': "Commerce d'alimentation générale",
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.2'),
     'lat': Decimal('48.847078'), 'lon': Decimal('2.303707'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8248938, 'nom': 'PICARD', 'adresse': '12 Rue Lecourbe 75015 Paris', 'siret': '78493968804769',
     'taille': '6-9', 'naf': '4711A', 'sector': 'Commerce de détail de produits surgelés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.844828'), 'lon': Decimal('2.309841'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8259657, 'nom': 'BOUCHERIE NOTRE DAME', 'adresse': '5 Place du Général Beuret 75015 Paris',
     'siret': '49119363700031', 'taille': '6-9', 'naf': '4722Z',
     'sector': 'Commerce de détail de viandes et de produits à base de viande en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.84199'), 'lon': Decimal('2.303283'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8275722, 'nom': 'BOUCHERIE CAMBRONNE DEBRAY', 'adresse': '90 Rue Cambronne 75015 Paris',
     'siret': '52428886700020', 'taille': '6-9', 'naf': '4722Z',
     'sector': 'Commerce de détail de viandes et de produits à base de viande en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842134'), 'lon': Decimal('2.302902'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8240256, 'nom': 'NATURALIA FRANCE', 'adresse': '86 Rue Cambronne 75015 Paris',
     'siret': '30247464800037', 'taille': '6-9', 'naf': '4729Z',
     'sector': 'Autres commerces de détail alimentaires en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'), 'lat': Decimal('48.84236'),
     'lon': Decimal('2.302741'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 4,
     'score_geo': 5, 'score_total': 40},
    {'id': 8249560, 'nom': 'AFFICAM', 'adresse': '93 Rue Cambronne 75015 Paris', 'siret': '48263443300023',
     'taille': '6-9', 'naf': '4729Z', 'sector': 'Autres commerces de détail alimentaires en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842247'), 'lon': Decimal('2.303101'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8278398, 'nom': 'LES HALLES CAMBRONNE', 'adresse': '91 Rue Cambronne 75015 Paris',
     'siret': '43393717400020', 'taille': '6-9', 'naf': '4711B', 'sector': "Commerce d'alimentation générale",
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.4'),
     'lat': Decimal('48.842362'), 'lon': Decimal('2.303019'), 'score_naf': 3, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 5, 'score_total': 40},
    {'id': 8269916, 'nom': 'BOULANGERIE DES BELLES FEUILLES',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris', 'siret': '75002614800023', 'taille': None,
     'naf': '1071C', 'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8401192'),
     'lon': Decimal('2.3024489'), 'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1,
     'score_geo': 3, 'score_total': 40},
    {'id': 8272456, 'nom': 'SOCIETE DE RESTAURATION BOULANGERE',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '45312796100036', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None,
     'distance': Decimal('0.6'), 'lat': Decimal('48.8401192'),
     'lon': Decimal('2.3024489'), 'score_naf': 5, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 1, 'score_geo': 3,
     'score_total': 40},
    {'id': 8286420, 'nom': 'BOULANGERIE CONVENTION',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '81813404100024', 'taille': None,
     'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie',
     'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8401192'),
     'lon': Decimal('2.3024489'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1,
     'score_size': 1, 'score_geo': 3,
     'score_total': 40},
    {'id': 8279991, 'nom': 'FOUR SAINT', 'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '80482987700013', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'), 'lon': Decimal('2.3002449'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 3,
     'score_total': 40},
    {'id': 8289915, 'nom': 'ERNEST & VALENTIN COMMERCE',
     'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '83263306900022', 'taille': None, 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8401192'), 'lon': Decimal('2.3024489'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 3,
     'score_total': 40},
    {'id': 8265387, 'nom': 'MONNIER - PORTELLA', 'adresse': '169 Rue de Vaugirard 75015 Paris',
     'siret': '45001711600010', 'taille': '0', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.7'), 'lat': Decimal('48.843347'), 'lon': Decimal('2.31423'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1, 'score_geo': 3,
     'score_total': 40},
    {'id': 8241920, 'nom': 'OGER DOMINIQUE', 'adresse': '108 Rue Blomet 75015 Paris', 'siret': '33942559700053',
     'taille': None, 'naf': '1071C', 'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.7'), 'lat': Decimal('48.840566'),
     'lon': Decimal('2.299301'), 'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1,
     'score_geo': 3, 'score_total': 40},
    {'id': 8277580, 'nom': 'NAULLEAU LIONEL', 'adresse': '100 Rue du Théâtre 75015 Paris',
     'siret': '75331252900013', 'taille': '1-2', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('0.8'), 'lat': Decimal('48.846587'), 'lon': Decimal('2.293943'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 2, 'score_geo': 2,
     'score_total': 40},
    {'id': 7813492, 'nom': 'LA PATISSERIE CYRIL LIGNAC', 'adresse': '133 Rue de Sèvres 75006 Paris',
     'siret': '81243340700036', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 6', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('1.0'), 'lat': Decimal('48.847239'), 'lon': Decimal('2.318013'),
     'score_naf': 5, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 1,
     'score_total': 40},
    {'id': 8269454, 'nom': 'MAISON ZAIBET', 'adresse': '55 Rue Paul Barruel 75015 Paris',
     'siret': '82347266700018', 'taille': '3-5', 'naf': '1071C',
     'sector': 'Boulangerie et boulangerie-pâtisserie', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('1.0'),
     'lat': Decimal('48.836855'), 'lon': Decimal('2.306437'), 'score_naf': 5,
     'score_welcome': 1, 'score_contact': 1, 'score_size': 3, 'score_geo': 1,
     'score_total': 40},
    {'id': 8305432, 'nom': 'GIMA DISTRIBUTION', 'adresse': '81 Rue Cambronne 75015 Paris',
     'siret': '84515639700018', 'taille': None, 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.843094'),
     'lon': Decimal('2.302665'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 1,
     'score_geo': 5, 'score_total': 39},
    {'id': 8283721, 'nom': 'ZM FRUITS', 'adresse': '83 Rue Lecourbe 75015 Paris', 'siret': '82978047700032',
     'taille': None, 'naf': '4721Z', 'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.843083'), 'lon': Decimal('2.304639'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 1, 'score_geo': 5, 'score_total': 39},
    {'id': 8273029, 'nom': 'DOUCEURS DE CARMELA', 'adresse': '100 Rue Lecourbe 75015 Paris',
     'siret': '82436032500016', 'taille': None, 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'),
     'lat': Decimal('48.843044'), 'lon': Decimal('2.303705'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 1, 'score_geo': 5, 'score_total': 39},
    {'id': 8250851, 'nom': 'XU JIANTONG', 'adresse': '224 Rue de Vaugirard 75015 Paris',
     'siret': '53166030600014', 'taille': '1-2', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.5'), 'lat': Decimal('48.840799'),
     'lon': Decimal('2.305228'), 'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 2,
     'score_geo': 4, 'score_total': 39},
    {'id': 8270896, 'nom': 'O PRINTEMPS DE VOUILLE',
     'adresse': 'Mairie du 15e Arrondissement (Hôtel de ville) Paris',
     'siret': '81067640300019', 'taille': '1-2', 'naf': '4721Z',
     'sector': 'Commerce de détail de fruits et légumes en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None,
     'distance': Decimal('0.6'), 'lat': Decimal('48.8413462'),
     'lon': Decimal('2.3002449'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 2, 'score_geo': 4,
     'score_total': 39},
    {'id': 8266384, 'nom': 'ABSIDE', 'adresse': 'Commissariat du 15e arrondissement (Police) Paris',
     'siret': '49458880900025', 'taille': '3-5', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.6'),
     'lat': Decimal('48.8401192'), 'lon': Decimal('2.3024489'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 3, 'score_total': 39},
    {'id': 8258618, 'nom': 'A LA PETITE CHOCOLATIERE', 'adresse': '66 Avenue de la Motte-picquet 75015 Paris',
     'siret': '53810185800032', 'taille': '3-5', 'naf': '4724Z',
     'sector': 'Commerce de détail de pain, pâtisserie et confiserie en magasin spécialisé',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.7'),
     'lat': Decimal('48.849505'), 'lon': Decimal('2.298172'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 3, 'score_geo': 3, 'score_total': 39},
    {'id': 8290903, 'nom': 'MADEMOISELLEDIS', 'adresse': '9 Rue Mademoiselle 75015 Paris',
     'siret': '81988364600021', 'taille': '6-9', 'naf': '4711D', 'sector': 'Supermarchés',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('0.8'),
     'lat': Decimal('48.843628'), 'lon': Decimal('2.294323'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 4, 'score_geo': 2, 'score_total': 39},
    {'id': 8258689, 'nom': 'FREDI', 'adresse': '327 Rue de Vaugirard 75015 Paris', 'siret': '44441077300188',
     'taille': '10-19', 'naf': '4711D', 'sector': 'Supermarchés', 'commune': 'PARIS 15', 'departement': '75',
     'phonenumber': None, 'distance': Decimal('1.0'), 'lat': Decimal('48.83798'), 'lon': Decimal('2.298083'),
     'score_naf': 4, 'score_welcome': 1, 'score_contact': 1, 'score_size': 5, 'score_geo': 1,
     'score_total': 39},
    {'id': 8259873, 'nom': 'BOULANGERIE LAURENT', 'adresse': '59 Boulevard de Vaugirard 75015 Paris',
     'siret': '49133340700014', 'taille': '10-19', 'naf': '1071D', 'sector': 'Pâtisserie',
     'commune': 'PARIS 15', 'departement': '75', 'phonenumber': None, 'distance': Decimal('1.0'),
     'lat': Decimal('48.840643'), 'lon': Decimal('2.316301'), 'score_naf': 4, 'score_welcome': 1,
     'score_contact': 1, 'score_size': 5, 'score_geo': 1, 'score_total': 39},
    {'id': 8271606, 'nom': 'PRESTIGE', 'adresse': '16 Rue Lecourbe 75015 Paris', 'siret': '45271647500010',
     'taille': '3-5', 'naf': '4711B', 'sector': "Commerce d'alimentation générale", 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.844809'),
     'lon': Decimal('2.309601'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 5, 'score_total': 38},
    {'id': 8252296, 'nom': 'FROMAGES ET DETAIL', 'adresse': '83 Rue Lecourbe 75015 Paris',
     'siret': '41485392900035', 'taille': '3-5', 'naf': '4729Z',
     'sector': 'Autres commerces de détail alimentaires en magasin spécialisé', 'commune': 'PARIS 15',
     'departement': '75', 'phonenumber': None, 'distance': Decimal('0.3'), 'lat': Decimal('48.843083'),
     'lon': Decimal('2.304639'), 'score_naf': 3, 'score_welcome': 1, 'score_contact': 1, 'score_size': 3,
     'score_geo': 5, 'score_total': 38}
]


def test_match_route(client):
    query = {'_v': 1, '_timestamp': '2020-08-08 11:38:41.626228+00:00',
             '_query_id': '8c38dad9-1ec5-4b06-9b57-cf2d8713492f',
             '_session_id': '15449a8c-174b-463d-b40a-2f98ccd1595d',
             'address': {'type': 'string', 'value': '12, rue François Bonvin - 75015 Paris'},
             'criteria': [
                 {'priority': 2, 'name': 'distance', 'distance_km': 10},
                 {'priority': 5, 'name': 'rome_codes',
                  'rome_list': [
                      {'id': 'D1106', 'include': True,
                       'exclude': False}],
                  'exclude_naf': []}
             ]
             }

    response = client.post("/match", json=query)
    assert response.status_code == 200

